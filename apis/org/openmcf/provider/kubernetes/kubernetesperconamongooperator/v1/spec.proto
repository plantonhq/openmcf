syntax = "proto3";

package org.openmcf.provider.kubernetes.kubernetesperconamongooperator.v1;

import "buf/validate/validate.proto";
import "org/openmcf/provider/kubernetes/kubernetes.proto";
import "org/openmcf/provider/kubernetes/options.proto";
import "org/openmcf/provider/kubernetes/target_cluster.proto";
import "org/openmcf/shared/foreignkey/v1/foreign_key.proto";

// **KubernetesPerconaMongoOperatorSpec** defines the configuration for deploying the Percona Operator for MongoDB
// on a Kubernetes cluster. This message specifies the parameters needed to create and manage the operator
// deployment within a Kubernetes environment. It includes container specifications to control resource allocation.
message KubernetesPerconaMongoOperatorSpec {
  // Target Kubernetes Cluster
  org.openmcf.provider.kubernetes.KubernetesClusterSelector target_cluster = 1;

  // Kubernetes Namespace
  org.openmcf.shared.foreignkey.v1.StringValueOrRef namespace = 2 [
    (buf.validate.field).required = true,
    (org.openmcf.shared.foreignkey.v1.default_kind) = KubernetesNamespace,
    (org.openmcf.shared.foreignkey.v1.default_kind_field_path) = "spec.name"
  ];

  // flag to indicate if the namespace should be created
  bool create_namespace = 3;

  // Container resource specifications for the operator
  KubernetesPerconaMongoOperatorSpecContainer container = 4 [(buf.validate.field).required = true];
}

// **KubernetesPerconaMongoOperatorSpecContainer** specifies the container configuration for the Percona operator.
// It includes resource allocations for CPU and memory to ensure the operator runs efficiently.
message KubernetesPerconaMongoOperatorSpecContainer {
  // CPU and memory resources for the operator pod
  org.openmcf.provider.kubernetes.ContainerResources resources = 1 [(org.openmcf.provider.kubernetes.default_container_resources) = {
    limits: {
      cpu: "1000m"
      memory: "1Gi"
    }
    requests: {
      cpu: "100m"
      memory: "256Mi"
    }
  }];
}
